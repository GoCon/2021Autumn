---
key: microservice-last-steps
title: マイクロサービス移行を仕上げる最後の数歩
id: microservice-last-steps
format: conference
talkType: ""
allroom: false
speakers:
- kenta_moriwaki
---
Rettyではおよそ10年以上動いているPHPのモノリスから、Goベースのマイクロサービスへの移行を続けています。
長く開発が行われていましたが、2021年の3月から部分的に本番で運用されることになりました。
育ち過ぎたモノリスからGo製マイクロサービスへの移行、実用までの最後の仕上げについてご紹介します。

---

- マイクロサービス移行で描いた青写真・計画
- マイクロサービス化はどこまで進んでいたか
  - モノリスの分割方法
    - 育ち過ぎたモノリス、綺麗な分割は骨が折れる
      - バックエンドにロジック、フロントエンドにもロジック
    - まずはその密結合を分離する
      - モノリスの持っている情報をそのまま利用するサービスを作る
  - 互換性の保ち方
    - protocol bufferの定義を入れたリポジトリを用意する
- 仕上げの話
  - 移行対象を絞り、まずはミニマムな形を目指す
  - 密結合は解消されたので、モノリスに依存したサービスを置き換えるようなサービスを作っていく
  - いつでも分割できるようなモジュラモノリスが誕生
    - ファイルディスクリプタの枯渇という落とし穴